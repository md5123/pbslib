#
# StartOS package build script
#
# Copyright 2012 StartOS
# Distributed under the terms of the GNU General Public License v2
#

DESCRIPTION="A scalable cross-platform server that combines SQL/RDF/XML Data Management with Web Application Server and Web Services Platform functionality"
HOMEPAGE="http://sourceforge.net/projects/virtuoso"
LICENSE="GPL+"
PACKAGER="StartOS Developers"

SRC_URI="http://sourceforge.net/projects/"$N"/files/"$N"/"$V"/"$N"-opensource-"$V".tar.gz"
CHECKSUM="61b53395e14a11dd7e7715b50261b9eb"

RDEPEND="cyrus-sasl glibc gnutls libgcrypt libgpg-error libtasn1 openldap openssl zlib"
RECOMMENDED=""
BDEPEND=""
OPTIONAL=""
CONFLICT=""

pbs_unpack() {
        dounpack
}

pbs_config() {
	config+=" --disable-rendezvous 
	          --disable-hslookup 
	          --disable-all-vads "
	doconfig
}

pbs_build() {
	domake
}

pbs_install() {
	# Install server
	cd binsrc/virtuoso
	domkinstall

	# Install driver
	cd "$srcdir"/binsrc/driver
	domkinstall

	# Install some useful tools; rename to avoid conflicts
	for bin in isql isqlw; do
		install -Dm755 "${srcdir}"/binsrc/tests/"$bin" "${pkgdir}"/usr/bin/"$bin"-vt
	done
}

