Submitted By: Jim Gifford (jim at cross-lfs dot org)
Date: 01-21-2009
Initial Package Version: 1.5.5
Origin: Gentoo
Upstream Status: Unknown
Description: Removes uneeded libraries.
             Also disables tests that prevent DESTDIR working.

Requires:  You will need to use make local-all && make install-all instead of
the normal make and make install

diff -Naur subversion-1.6.4.orig/build/ac-macros/apr.m4 subversion-1.6.4/build/ac-macros/apr.m4
--- subversion-1.6.4.orig/build/ac-macros/apr.m4	2008-06-12 21:43:54.000000000 +0000
+++ subversion-1.6.4/build/ac-macros/apr.m4	2009-08-08 23:51:09.056593143 +0000
@@ -76,14 +76,14 @@
 
   dnl When APR stores the dependent libs in the .la file, we don't need 
   dnl --libs.
-  SVN_APR_LIBS="`$apr_config --link-libtool --libs`"
+  SVN_APR_LIBS="`$apr_config --link-libtool`"
   if test $? -ne 0; then
-    AC_MSG_ERROR([apr-config --link-libtool --libs failed])
+    AC_MSG_ERROR([apr-config --link-libtool failed])
   fi
 
-  SVN_APR_EXPORT_LIBS="`$apr_config --link-ld --libs`"
+  SVN_APR_EXPORT_LIBS="`$apr_config --link-ld`"
   if test $? -ne 0; then
-    AC_MSG_ERROR([apr-config --link-ld --libs failed])
+    AC_MSG_ERROR([apr-config --link-ld failed])
   fi
 
   SVN_APR_SHLIB_PATH_VAR="`$apr_config --shlib-path-var`"
diff -Naur subversion-1.6.4.orig/build/ac-macros/aprutil.m4 subversion-1.6.4/build/ac-macros/aprutil.m4
--- subversion-1.6.4.orig/build/ac-macros/aprutil.m4	2008-10-02 15:06:28.000000000 +0000
+++ subversion-1.6.4/build/ac-macros/aprutil.m4	2009-08-08 23:51:53.459604657 +0000
@@ -79,14 +79,14 @@
 
   dnl When APR stores the dependent libs in the .la file, we don't need
   dnl --libs.
-  SVN_APRUTIL_LIBS="`$apu_config --link-libtool --libs`"
+  SVN_APRUTIL_LIBS="`$apu_config --link-libtool`"
   if test $? -ne 0; then
-    AC_MSG_ERROR([apu-config --link-libtool --libs failed])
+    AC_MSG_ERROR([apu-config --link-libtool failed])
   fi
 
-  SVN_APRUTIL_EXPORT_LIBS="`$apu_config --link-ld --libs`"
+  SVN_APRUTIL_EXPORT_LIBS="`$apu_config --link-ld`"
   if test $? -ne 0; then
-    AC_MSG_ERROR([apu-config --link-ld --libs failed])
+    AC_MSG_ERROR([apu-config --link-ld failed])
   fi
 
   AC_SUBST(SVN_APRUTIL_INCLUDES)
diff -Naur subversion-1.6.4.orig/configure subversion-1.6.4/configure
--- subversion-1.6.4.orig/configure	2009-08-04 04:57:14.000000000 +0000
+++ subversion-1.6.4/configure	2009-08-08 23:52:25.949608949 +0000
@@ -25517,10 +25517,10 @@
 INSTALL_STATIC_RULES="install-bin install-docs"
 INSTALL_RULES="install-fsmod-lib install-ramod-lib install-lib install-include install-static"
 INSTALL_RULES="$INSTALL_RULES $INSTALL_APACHE_RULE"
-BUILD_RULES="fsmod-lib ramod-lib lib bin test $BUILD_APACHE_RULE"
+BUILD_RULES="fsmod-lib ramod-lib lib bin $BUILD_APACHE_RULE"
 
 if test "$svn_lib_berkeley_db" = "yes"; then
-  BUILD_RULES="$BUILD_RULES bdb-lib bdb-test"
+  BUILD_RULES="$BUILD_RULES bdb-lib"
   INSTALL_RULES="`echo $INSTALL_RULES | sed 's/install-fsmod-lib/install-fsmod-lib install-bdb-lib/'`"
   INSTALL_STATIC_RULES="$INSTALL_STATIC_RULES install-bdb-lib"
   BDB_TEST_DEPS="\$(BDB_TEST_DEPS)"
