Ubuntu: needed for Wubi
Description: Ignore devices loop-mounted from files in 10_linux.
UbuntuSpecific: Not inherently, but perhaps we should integrate 10_lupin
 properly instead.


diff -ur grub2-1.98-ylmf2/util/grub.d/10_linux.in grub2-1.98-ylmf2.new/util/grub.d/10_linux.in
--- grub2-1.98-ylmf2/util/grub.d/10_linux.in	2011-05-25 16:58:17.232853041 +0800
+++ grub2-1.98-ylmf2.new/util/grub.d/10_linux.in	2011-05-25 17:00:06.019518266 +0800
@@ -39,6 +39,11 @@
 case ${GRUB_DEVICE} in
   /dev/loop/*|/dev/loop[0-9])
     GRUB_DEVICE=`losetup ${GRUB_DEVICE} | sed -e "s/^[^(]*(\([^)]\+\)).*/\1/"`
+    # We can't cope with devices loop-mounted from files here.
+    case ${GRUB_DEVICE} in
+        /dev/*) ;;
+        *) exit 0 ;;
+    esac
   ;;
 esac
 
