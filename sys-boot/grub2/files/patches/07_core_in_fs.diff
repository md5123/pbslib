Index: util/i386/pc/grub-setup.c
===================================================================
--- util/i386/pc/grub-setup.c	(revision 2220)
+++ util/i386/pc/grub-setup.c	(working copy)
@@ -53,6 +53,7 @@ static const grub_gpt_part_type_t grub_g

 #define DEFAULT_BOOT_FILE	"boot.img"
 #define DEFAULT_CORE_FILE	"core.img"
+#define CORE_IMG_IN_FS		"setup_left_core_image_in_filesystem"

 /* This is the blocklist used in the diskboot image.  */
 struct boot_blocklist
@@ -388,6 +389,8 @@ setup (const char *dir,
 		       boot_img))
     grub_util_error ("%s", grub_errmsg);

+  unlink (DEFAULT_DIRECTORY "/" CORE_IMG_IN_FS);
+
   goto finish;

 unable_to_embed:
@@ -402,6 +405,9 @@ unable_to_embed:
   if (! force)
     grub_util_error ("If you really want blocklists, use --force.");

+  fp = fopen (DEFAULT_DIRECTORY "/" CORE_IMG_IN_FS, "w");
+  fclose (fp);
+
   /* Make sure that GRUB reads the identical image as the OS.  */
   tmp_img = xmalloc (core_size);
   core_path_dev = grub_util_get_path (dir, core_file);
