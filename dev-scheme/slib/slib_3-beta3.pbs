#
# StartOS package build script
#
# Copyright 2012 StartOS
# Distributed under the terms of the GNU General Public License v2
#

DESCRIPTION="SLIB is a portable library for the programming language Scheme."
HOMEPAGE="http://people.csail.mit.edu/jaffer/SLIB"
LICENSE="custom"
PACKAGER="Zhongxin Huang <huangzhongxin@ivali.com>"

SRC_URI="http://groups.csail.mit.edu/mac/ftpdir/scm/slib-3b3.zip"

RDEPEND="guile texinfo"
BDEPEND=""
RECOMMENDED=""
CONFLICT=""

INSTALL="$N.install"

pbs_unpack() {
    dounpack
}

pbs_install() {
     sed -r -i "s,/usr/(local/)?lib/slib,/usr/share/slib,g" *.init
     docp *.scm *.init *.xyz *.txt *.dat *.ps "$PKGDIR/usr/share/slib/"
     docp slib.info "$PKGDIR/usr/share/info/"

         install -m755 -d "$PKGDIR/usr/bin"
     cat << _EOF > "$PKGDIR/usr/bin/slib"
#!/bin/sh
SCHEME_LIBRARY_PATH=/usr/share/slib/
export SCHEME_LIBRARY_PATH
VERSION=${V}
S48_VICINITY="/usr/share/scheme48/"
export S48_VICINITY
_EOF

cat slib.sh >> "$PKGDIR/usr/bin/slib"
chmod 755 "$PKGDIR/usr/bin/slib"

doman slib.1
dodoc COPYING

doln /usr/share/slib "$PKGDIR/usr/share/guile/site/slib"
}

