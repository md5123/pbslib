#
# YLmf_OS package build script
#

DESCRIPTION="Sun's Java Development Kit"
HOMEPAGE="http://java.sun.com"
REPO=""
LICENSE=""
PACKAGER="Ylmf OS Developers <ylmfos@115.com>"

SRC_URI="http://download.oracle.com/auth/otn-pub/java/jdk/6u25-b06/jdk-6u25-linux-i586.bin"

RDEPEND="glibc jre"
BDEPEND=""
RECOMMENDED=""
CONFLICT=""

NOTES=""

pbs_unpack() {
	mkdir -p "$N-$V$R"
	cd "$N-$V$R"
	mkdir -p unbundle-jdk
	cd unbundle-jdk
	sh "$YPPATH_SOURCE"/jdk-6u25-linux-i586.bin --accept-license
	cd ../
	sh "$FILES_PATH"/files/construct.sh unbundle-jdk linux-jdk linux-jre
}

pbs_install() {
	#make DESTDIR="$YPPATH_DEST" install
	#copy icon
	ypkg_docp_rename linux-jdk/jre/lib/desktop/icons/hicolor/48x48/apps/sun-java.png "$YPPATH_DEST"/usr/share/pixmaps/java.png
	rm -rf linux-jdk/jre
	ypkg_docp linux-jdk/* "$YPPATH_DEST"/opt/java/
	ypkg_docp_rename "$FILES_PATH"/files/jdk.profile    "$YPPATH_DEST"/etc/profile.d/jdk.sh
	ypkg_docp_rename "$FILES_PATH"/files/jdk.profile.csh "$YPPATH_DEST"/etc/profile.d/jdk.csh
	
	cd "$YPPATH_DEST"
	ypkg_docp opt/java/linux-jdk/{COPYRIGHT,LICENSE,THIRDPARTYLICENSEREADME.txt} usr/share/licenses/jdk/
	#desktop entries
	ypkg_dodesktop java-control-panel.desktop java-monitoring-and-management-console.desktop java-policy-settings.desktop java-visualvm.desktop java-web-start.desktop
	#
	ypkg_doln   opt/java/jdk/jre
}

pbs_postinst() {
	echo "The jdk package is licensed software."
        echo "You MUST read and agree to the license stored in"
        echo "/opt/java/LICENSE before using it."
}

