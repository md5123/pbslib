#
# StartOS package build script
#
# Copyright 2012 StartOS
# Distributed under the terms of the GNU General Public License v2
#

DESCRIPTION="a simple, small, C++ XML parser that can be easily integrating into other programs"
HOMEPAGE="http://www.grinninglizard.com/tinyxml/index.html"
LICENSE="GPL"
PACKAGER="StartOS Developers"

SRC_URI="http://downloads.sourceforge.net/project/"$N"/"$N"/"$V$R"/${N}_2_6_1.zip"

RDEPEND="gcc-libs"
BDEPEND=""
RECOMMENDED=""
CONFLICT=""

pbs_unpack() {
        dounpack
}

pbs_config() {
	doconfig
}

pbs_build() {
	sed -i.orig -e 's/\(^TINYXML_USE_STL := \)NO/\1YES/' -e 's/^RELEASE_CFLAGS.*/& -fPIC/' Makefile
	domake
	g++ -fPIC -shared -o libtinyxml.so.0."$V" -Wl,-soname,libtinyxml.so.0 *.o
}

pbs_install() {
	docp *.so* "$destdir"/usr/lib/
        docp *.h "$destdir"/usr/include
        dodoc {changes,readme}.txt dodocs/*
	cd "$destdir"/usr/lib/
	doln libtinyxml.so.0."$V" libtinyxml.so.0
	doln libtinyxml.so.0."$V" libtinyxml.so
}

