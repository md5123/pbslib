#
# YLmf_OS package build script
#

DESCRIPTION="The GLib library of C routines"
HOMEPAGE="http://www.gtk.org/"
REPO="testing"
SRC_URI="http://ftp.gnome.org/pub/gnome/sources/glib/2.25/glib-$V.tar.bz2"
BIN_URI=""

RDEPEND=""
BDEPEND="${RDEPEND} pkgconfig sys-libs/zlib"
RECOMMEDNED="libpcre"
OPIONAL="attr gamin gtk-doc python"

NOTES="Gamin requires GLib in order to compile; therefore, you must first install GLib, then compile Gamin, and recompile GLib against it.
      --with-pcre=system: This parameter causes the build to use a system-provided version of the PCRE library instead of an internal version."

pbs_unpack()
{
	#unpard file from $YPPATH_SOURCE to current directory.
	echo "Unpacking to `pwd`"
        ypkg_unpack
}

pbs_config()
{
	echo "config glib-$V$R..."
	#fist, cd build directory
	cd glib-$V
	#second, add package specified config params to YPB_CONFIG
	YPB_CONFIG+=" --prefix=/usr
		     --disable-gtk-doc	"
	             #--with-pcre=system
	#Third, call configure with $YPB_CONFIG
	ypkg_config
}

pbs_build()
{
	echo "make "$N-$V$R"..."
	#run make in current directory
	ypkg_make
}

pbs_check()
{
	echo "checking "$N-$V$R".."
	#make check
}

pbs_install()
{
	echo "install to $YPPATH_DEST"
	#install everything to $YPPATH_DEST
	ypkg_mkinstall
	chmod -v 755 "$YPPATH_DEST"/usr/bin/gtester-report
}

pbs_postinst()
{	
	mkdir -p /etc/profile.d
	cat > /etc/profile.d/glib2-locale.sh << "EOF"
	# Use the current locale charset for filenames
	# in applications using GLib
	export G_FILENAME_ENCODING=@locale
EOF
}
	
